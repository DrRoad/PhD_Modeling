import os, sys
from random import *
import numpy as np
import traci
import traci.constants as tc
import re
import sumolib
import time
#import SUMO_PYTHON.Pavement_Condition as PC
import pandas as pd

caliTESTPATH = '/Users/Biko/Documents/GitHub/PhD_Modeling/Calibrator_Test/cali-TEST-Run_Files/cali-TEST-Routing/Edges_IN_Routes.csv'

Routes_DF = pd.DataFrame([('START-Finish-Routed', ['START', '0_0-1_0', '1_0-2_0', '', '2_0-3_0', '3_0-3_1', '3_1-3_2', 'FINISH']),('0_0-0_1-Finish-Routed', ['0_0-0_1', '0_1-1_1', '1_1-2_1', '2_1-3_1', '3_1-3_2', 'FINISH']),('0_0-1_0-Finish-Routed', ['0_0-1_0', '1_0-1_1', '1_1-2_1', '2_1-3_1', '3_1-3_2', 'FINISH']),('0_1-0_0-Finish-Routed', ['0_1-0_0', '0_0-1_0', '1_0-1_1', '1_1-2_1', '2_1-3_1', '3_1-3_2', 'FINISH']),('0_1-0_2-Finish-Routed', ['0_1-0_2', '0_2-1_2', '1_2-2_2', '2_2-3_2', 'FINISH']),('0_1-1_1-Finish-Routed', ['0_1-1_1', '1_1-2_1', '2_1-3_1', '3_1-3_2', 'FINISH']),('0_2-0_1-Finish-Routed', ['0_2-0_1', '0_1-1_1', '1_1-2_1', '2_1-3_1', '3_1-3_2', 'FINISH']),('0_2-1_2-Finish-Routed', ['0_2-1_2', '1_2-2_2', '2_2-3_2', 'FINISH']),('1_0-0_0-Finish-Routed', ['1_0-0_0', '0_0-0_1', '0_1-1_1', '1_1-2_1', '2_1-3_1', '3_1-3_2', 'FINISH']),('1_0-1_1-Finish-Routed', ['1_0-1_1', '1_1-2_1', '2_1-3_1', '3_1-3_2', 'FINISH']),('1_0-2_0-Finish-Routed', ['1_0-2_0', '2_0-3_0', '3_0-3_1', '3_1-3_2', 'FINISH']),('1_1-0_1-Finish-Routed', ['1_1-0_1', '0_1-0_2', '0_2-1_2', '1_2-2_2', '2_2-3_2', 'FINISH']),('1_1-1_0-Finish-Routed', ['1_1-1_0', '1_0-2_0', '2_0-3_0', '3_0-3_1', '3_1-3_2', 'FINISH']),('1_1-2_1-Finish-Routed', ['1_1-2_1', '2_1-3_1', '3_1-3_2', 'FINISH']),('1_2-0_2-Finish-Routed', ['1_2-0_2', '0_2-0_1', '0_1-1_1', '1_1-2_1', '2_1-3_1', '3_1-3_2', 'FINISH']),('1_2-2_2-Finish-Routed', ['1_2-2_2', '2_2-3_2', 'FINISH']),('2_0-1_0-Finish-Routed', ['2_0-1_0', '1_0-1_1', '1_1-2_1', '2_1-3_1', '3_1-3_2', 'FINISH']),('2_0-3_0-Finish-Routed', ['2_0-3_0', '3_0-3_1', '3_1-3_2', 'FINISH']),('2_1-1_1-Finish-Routed', ['2_1-1_1', '1_1-1_0', '1_0-2_0', '2_0-3_0', '3_0-3_1', '3_1-3_2', 'FINISH']),('2_1-2_2-Finish-Routed', ['2_1-2_2', '2_2-3_2', 'FINISH']),('2_1-3_1-Finish-Routed', ['2_1-3_1', '3_1-3_2', 'FINISH']),('2_2-1_2-Finish-Routed', ['2_2-1_2', '1_2-0_2', '0_2-0_1', '0_1-1_1', '1_1-2_1', '2_1-3_1', '3_1-3_2', 'FINISH']),('2_2-2_1-Finish-Routed', ['2_2-2_1', '2_1-3_1', '3_1-3_2', 'FINISH']),('2_2-3_2-Finish-Routed', ['2_2-3_2', 'FINISH']),('3_0-2_0-Finish-Routed', ['3_0-2_0', '2_0-1_0', '1_0-1_1', '1_1-2_1', '2_1-3_1', '3_1-3_2', 'FINISH']),('3_0-3_1-Finish-Routed', ['3_0-3_1', '3_1-3_2', 'FINISH']),('3_1-2_1-Finish-Routed', ['3_1-2_1', '2_1-2_2', '2_2-3_2', 'FINISH']),('3_1-3_0-Finish-Routed', ['3_1-3_0', '3_0-3_1', '3_1-3_2', 'FINISH']),('3_1-3_2-Finish-Routed', ['3_1-3_2', 'FINISH']),('3_2-2_2-Finish-Routed', ['3_2-2_2','2_2-3_2', 'FINISH']),('3_2-3_1-Finish-Routed', ['3_2-3_1','3_1-3_2', 'FINISH'])])


Edge_LIST = ('0_0-0_1','0_0-1_0','0_1-0_0','0_1-0_2','0_1-1_1','0_2-0_1','0_2-1_2','1_0-0_0','1_0-1_1','1_0-2_0','1_1-0_1','1_1-1_0','1_1-2_1','1_2-0_2','1_2-2_2','2_0-1_0','2_0-3_0','2_1-1_1','2_1-2_2','2_1-3_1','2_2-1_2','2_2-2_1','2_2-3_2','3_0-2_0','3_0-3_1','3_1-2_1','3_1-3_0','3_1-3_2','3_2-2_2','3_2-3_1','FINISH','START')
routeLIST = ('START-Finish-Routed','0_0-0_1-Finish-Routed', '0_0-1_0-Finish-Routed', '0_1-0_0-Finish-Routed', '0_1-0_2-Finish-Routed', '0_1-1_1-Finish-Routed', '0_2-0_1-Finish-Routed', '0_2-1_2-Finish-Routed', '1_0-0_0-Finish-Routed', '1_0-1_1-Finish-Routed', '1_0-2_0-Finish-Routed', '1_1-0_1-Finish-Routed', '1_1-1_0-Finish-Routed', '1_1-2_1-Finish-Routed', '1_2-0_2-Finish-Routed', '1_2-2_2-Finish-Routed', '2_0-1_0-Finish-Routed', '2_0-3_0-Finish-Routed', '2_1-1_1-Finish-Routed', '2_1-2_2-Finish-Routed', '2_1-3_1-Finish-Routed', '2_2-1_2-Finish-Routed', '2_2-2_1-Finish-Routed', '2_2-3_2-Finish-Routed', '3_0-2_0-Finish-Routed', '3_0-3_1-Finish-Routed', '3_1-2_1-Finish-Routed', '3_1-3_0-Finish-Routed', '3_1-3_2-Finish-Routed', '3_2-2_2-Finish-Routed', '3_2-3_1-Finish-Routed')

Edges_N_Routes_OLD = pd.DataFrame([('START-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('0_0-0_1-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('0_0-1_0-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('0_1-0_0-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('0_1-0_2-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('0_1-1_1-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('0_2-0_1-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('0_2-1_2-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('1_0-0_0-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('1_0-1_1-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('1_0-2_0-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('1_1-0_1-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('1_1-1_0-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('1_1-2_1-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('1_2-0_2-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('1_2-2_2-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('2_0-1_0-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('2_0-3_0-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('2_1-1_1-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('2_1-2_2-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('2_1-3_1-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('2_2-1_2-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('2_2-2_1-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('2_2-3_2-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('3_0-2_0-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('3_0-3_1-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('3_1-2_1-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('3_1-3_0-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('3_1-3_2-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('3_2-2_2-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]), ('3_2-3_1-Finish-Routed', [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])])

Edges_N_Routes_0 = {"0_0-0_1": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "0_0-1_0": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "0_1-0_0": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "0_1-0_2": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "0_1-1_1": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "0_2-0_1": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "0_2-1_2": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "1_0-0_0": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "1_0-1_1": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "1_0-2_0": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "1_1-0_1": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "1_1-1_0": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "1_1-2_1": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "1_2-0_2": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "1_2-2_2": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "2_0-1_0": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "2_0-3_0": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "2_1-1_1": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "2_1-2_2": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "2_1-3_1": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "2_2-1_2": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "2_2-2_1": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "2_2-3_2": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "3_0-2_0": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "3_0-3_1": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "3_1-2_1": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "3_1-3_0": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "3_1-3_2": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "3_2-2_2": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "3_2-3_1": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "FINISH": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0'], "START": ['0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0']}
Edges_N_Routes = pd.DataFrame(Edges_N_Routes_0,index=routeLIST)

#df.loc[row_indexer,column_indexer] 
### https://pandas.pydata.org/pandas-docs/stable/indexing.html
rowNUM = 0
colNUM = 0
### no diff in outcomes I just like the one below better
# for route_i in range(31):
	# #print(Edge_LIST[edge_i],"edgeNUM = ",edgeNUM)
	# for edge_i in range(32):
		# if Edge_LIST[edge_i] in Routes_DF.iloc[route_i,1]:
			# #print("Edge ", Edge_LIST[edge_i]," has been found in route: ",Routes_DF.loc[route_i,0])
			# #edgeName = Edge_LIST[edge_i]
			# Edges_N_Routes.iloc[route_i,edge_i] = routeLIST[route_i] #Edges_N_Routes.iloc[rowNUM,colNUM]
			# print("\nedge_i = ",edge_i,"\tAKA...",Edge_LIST[edge_i],"For Index Check:::\nroute_i = ",route_i, "\tAKA...",Routes_DF.iloc[route_i,0],"Does it match any?\n",Routes_DF.iloc[route_i,1])
			# #input("Go On")
		# colNUM = colNUM +1
	# rowNUM = rowNUM +1
	# Edges_N_Routes.to_csv(caliTESTPATH)

for edge_i in range(32):
	#print(Edge_LIST[edge_i],"edgeNUM = ",edgeNUM)
	for route_i in range(30):
		if Edge_LIST[edge_i] in Routes_DF.iloc[route_i,1]:
			#print("Edge ", Edge_LIST[edge_i]," has been found in route: ",Routes_DF.loc[route_i,0])
			#edgeName = Edge_LIST[edge_i]
			Edges_N_Routes.iloc[route_i,edge_i] = routeLIST[route_i] #Edges_N_Routes.iloc[rowNUM,colNUM]
			print("For Index Check:::\nedge_i = ",Edge_LIST[edge_i],"\tAKA...",edge_i,"For Index Check:::\nroute_i = ",Routes_DF.iloc[route_i,0], "\tAKA...",route_i,"Does it match any?\n",Routes_DF.iloc[route_i,1])
			#input("Go On")
		colNUM = colNUM +1
	rowNUM = rowNUM +1
	Edges_N_Routes.to_csv(caliTESTPATH)


	
# Edges_N_Routes.to_csv(caliTESTPATH)
# edge_ParametersDF = pd.read_csv(condition.EdgeParamPANDAPATH)